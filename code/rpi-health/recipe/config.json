{
    "RecipeFormatVersion": "2020-01-25",
    "ComponentName": "RPiHealth",
    "ComponentVersion": "1.0.2",
    "ComponentDescription": "Component that reads out the cpu_temperature, cpu_usage and memory_usage of the Raspberry Pi.",
    "ComponentPublisher": "Miranda",
    "ComponentDependencies": {
        "aws.greengrass.DockerApplicationManager": {
            "VersionRequirement": "~2.0.0"
        },
        "aws.greengrass.TokenExchangeService": {
            "VersionRequirement": "~2.0.0"
        }
    },
    "ComponentConfiguration": {
        "DefaultConfiguration": {
            "topic": "plense/plensor",
            "message": "Hello World from Plense!",
            "qos": "1",
            "accessControl": {
                "aws.greengrass.ipc.mqttproxy": {
                    "dockercontainer:mqttproxy:1": {
                        "policyDescription": "Allows MQTT connection from AWS IoT Core",
                        "operations": [
                            "aws.greengrass#PublishToIoTCore"
                        ],
                        "resources": [
                            "plense/plensor"
                        ]
                    }
                }
            }
        }
    },
    "Manifests": [
        {
            "Platform": {
                "os": "linux"
            },
            "Lifecycle": {
                "run": "docker run --privileged -v /greengrass/v2/logs:/greengrass/v2/logs -v /home/plense/pi_readings:/home/plense/pi_readings -v /etc/timezone:/etc/timezone:ro -v /etc/localtime:/etc/localtime:ro -v /home/plense/metadata:/home/plense/metadata -v /etc/hostname:/etc/container_hostname -v /home/plense/.aws/credentials:/.aws/credentials -e IN_CONTAINER=True -e AWS_CONFIG_FILE=/.aws/credentials -e AWS_REGION=eu-central-1 -e DATABASE_NAME=rpi-health-prd -e TABLE_NAME=plense-fleet-manager-prd -v {kernel:rootPath}/ipc.socket:{kernel:rootPath}/ipc.socket -e SVCUID -e AWS_GG_NUCLEUS_DOMAIN_SOCKET_FILEPATH_FOR_COMPONENT -e MQTT_TOPIC=\"{configuration:/topic}\" -e MQTT_MESSAGE=\"{configuration:/message}\" -e MQTT_QOS=\"{configuration:/qos}\" 106005884410.dkr.ecr.eu-west-1.amazonaws.com/ggrepository:rpi-health-001"
            },
            "Artifacts": [
                {
                    "URI": "docker:106005884410.dkr.ecr.eu-west-1.amazonaws.com/ggrepository:rpi-health-001"
                }
            ]
        }
    ]
}
